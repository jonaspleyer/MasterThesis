\begin{section}{Numerical Solutions}
\begin{subsection}{Comparing TOV and LE results with a polytropic EOS}
In this section the numerical solutions of the \ac{TOV} equation
\begin{align}
	\frac{\partial m}{\partial r} &= 4\pi\rho r^2\label{4-NumSol-TOVEqBasic1}\\
	\frac{\partial p}{\partial r} &=-\frac{m\rho}{r^2}\left(1+\frac{p}{\rho}\right)\left(\frac{4\pi r^3p}{m}+1\right)\left(1-\frac{2m}{r}\right)^{-1}
	\label{4-NumSol-TOVEqBasic2}
\end{align}
as derived previously in section \ref{3-Mass-TOVDerivation} will be discussed. To obtain numerical solvability a equation of state in the form $\rho(r,p)$ is supplied. 
% TODO Add reference for when the equations are solvable
In Figure \ref{4-NumSol-TOVEqEasyEOS} a plot of such a solution is presented.
The density $\rho$ is derived via the equation \eqref{4-NumSol-TOVEqBasic1} and the integration is done with a 4th order Runge-Kutta Method \cite{rungeUeberNumerischeAufloesung1895, schlömilch1901zeitschrift, h.SimplifiedDerivationAnalysis2010}.
The integration is stopped once the pressure reaches values $p\leq0$. The initial value of \eqref{4-NumSol-TOVEqBasic1} is $\partial_r m(r=0)=0$. For equation \eqref{4-NumSol-TOVEqBasic1}, the initial value can be calculated when applying L'Hôpital's rule and combining them to obtain
\begin{alignat}{5}
	\lim\limits_{r\rightarrow0}\frac{m}{r} &= \lim\limits_{r\rightarrow0}\frac{\partial m}{\partial r} &&=\lim\limits_{r\rightarrow0}\frac{4\pi\rho r^2}{1} &&= 0\\
	\lim\limits_{r\rightarrow0}\frac{m}{r^2} &= \lim\limits_{r\rightarrow0}\frac{1}{2r}\frac{\partial m}{\partial r}  &&= \lim\limits_{r\rightarrow0}\frac{4\pi\rho r^2}{2r} &&= 0\\
	\lim\limits_{r\rightarrow0}\frac{m}{r^3} &= \lim\limits_{r\rightarrow0}\frac{1}{3r^2}\frac{\partial m}{\partial r} &&=\lim\limits_{r\rightarrow0}\frac{4\pi\rho r^2}{3r^2} &&= \frac{4\pi\rho_0}{3}\\
	\lim\limits_{r\rightarrow0}\frac{\partial p}{\partial r} &= 0
\end{alignat}
Explicit code can be found in \cite{pleyerGithubRepositoryJonas2021}. The Lane-Emden equation was obtained in section \ref{3-Mass-LEDerivation} as the non-relativistic limit of the \ac{TOV} equation by neglecting terms of order $1/c^2$ and higher and setting $G=c=1$. To obtain numerical results for the \ac{LE} equation as given in equation \eqref{3-Mass-Lane-Emden-Eq}, a substitution of the form $d\theta/d\xi=\chi$ was used.
\begin{alignat}{3}
	\frac{d\theta}{d\xi} &= \chi &\hspace{1cm} \left.\frac{d\theta}{d\xi}\right|_{\xi=0} &= 0\\
	\frac{d\chi}{d\xi} &= -\frac{2}{\xi}\chi-\theta^n & \left.\frac{d\chi}{d\xi}\right|_{\xi=0} &= -\theta^n
	\label{4-NumSol-LE-Substitution}
\end{alignat}
where the initial value for $d\chi/d\xi$ can be calculated with L'Hôpital's rule. With the conversion factor $\alpha$ derived in section \ref{3-Mass-LEDerivation}, \ac{TOV} and \ac{LE} results can be compared. Figure \ref{4-NumSol-TOVEqEasyEOS} shows the solution of both equations for the parameters of table \ref{4-NumSol-TOVParameters}. Note that values in the last part are calculated instead of supplied to the solving routine. Additionally conversion equations to compare \ac{TOV} and \ac{LE} results are displayed.\\
Since the mass reads
\begin{equation}
	m(r) = \int\limits_0^r 4\pi r'^2\rho(r')dr',
\end{equation}
we expect $\partial m/\partial r(R)=0$ if $p(R)=0$ when choosing a polytropic equation of state with $\gamma>0$. The plot in figure \ref{4-NumSol-TOVEqEasyEOS} shows this expected behaviour for the Lane Emden equation at $r\approx2.31$ and has the same behaviour for the \ac{TOV} results at $r\approx6.80$.\footnote{For the purpose of nicely displaying the calculated result, the plot only shows result up to $r=2.5$}
\begin{table}[H]
	\renewcommand{\arraystretch}{1.2}
	\centering
	\begin{tabular}{@{}llcll@{}}
		\toprule
		\multicolumn{2}{c}{\textbf{TOV}} & \phantom{abc} &\multicolumn{2}{c}{\textbf{LE}}\\
		\cmidrule{1-2} \cmidrule{4-5}
		EOS & $\rho=Ap^{1/\gamma}$ && EOS & $p=K\rho^{\gamma}$\\
		$A$ & $2$ & & \\
		$\gamma=1+\frac{1}{n}$ & $4/3$ && $n=1/(\gamma-1)$ & $3$\\
		$p_0$ & $0.5$ && $\theta_0$ & $1$\\
		$m_0$ & $0$ && $d\theta_0$ & $0$\\
		$dr$ & $0.01$ && $d\xi=dr/\alpha$ & $0.01/0.3355\approx0.0298$\\
		\cmidrule{1-2} \cmidrule{4-5}
		$\rho_0=Ap_0^{1/\gamma}$ & $2(2)^{\frac{4}{3}}\approx1.1892$ && $\lambda=\rho_0$ & $2(2)^{\frac{4}{3}}\approx1.1892$\\
		&&& $K=A^{-1/\gamma}$ & $2^{-3/4}\approx0.5946$\\
		&&& $\alpha^2=((n+1)K\lambda^{1/n-1})/(4\pi)$ & $\approx0.1125$\\
		\bottomrule
	\end{tabular}
	\caption[Numerical Parameters for TOV and LE equation]{Parameters for numerical solving of the \ac{TOV} and \ac{LE} equation.}
	\label{4-NumSol-TOVParameters}
\end{table}%
\begin{figure}[H]
	\centering
	\import{pictures/4-NumericalSolutions/}{TOV-LE-Combi.pgf}
	\caption[Comparison TOV and LE equation]{Comparison of the fully relativistic \ac{TOV} result and the classical Lane-Emden solution. The images show the plots for the parameters of table \ref{4-NumSol-TOVParameters}. First the pressure is presented. Afterwards the density calculated with the given EOS and the average density $\bar{\rho}_i=(4\pi/3)^{-1}m_i/r^3$ for the two solutions are beeing compared. In the second row, the mass and the ratio $m_i/r$ can be seen.}
	\label{4-NumSol-TOVEqEasyEOS}
\end{figure}
\end{subsection}
%
%
\begin{subsection}{Verifying the results}
\label{4-NumSol-Sec-Verifiying-the-results}
% Verification is done in different ways. 
% First, o
One can compare calculated \ac{LE} results with already known exact  solutions for certain exponents as given in table \ref{3-Mass-LE-Exact-Results}. 
All calculations are carried out with a chosen step size of $d\xi=0.03$.\\
The graphs overall show good numerical agreement. 
Initial values at $r=0$ are identical since they were set to be. 
The spike occurring afterwards can be explained by equation \eqref{4-NumSol-LE-Substitution}. 
The initial value of all derivatives is identically $0$ which means no change of value for $\theta$ or $\chi$ for the initial step of the numerical integration. 
On the other hand the exact results will see a change which explains the large discrepancy in the beginning.
It is clear that the relative difference on the right hand side will spike again once smaller values for $\theta$ are reached if the absolute difference stays constant. 
This behaviour is best seen in the solution for $n=5$ where a large range of $0\leq r\leq100$ for solving was chosen. 
The offset between the numerically calculated values and the exact result stays constant while the value of $\theta$ decreases inverse proportionally.
Despite this behaviour we can see that the criterion for convergence is fulfilled in the last column of figure \ref{4-NumSol-ValidateLEResults}.
\begin{figure}[H]
	\centering
% 	\import{pictures/4-NumericalSolutions/}{LE-ValidateSols.pgf}
	\import{pictures/4-NumericalSolutions/}{LE-ValidateSols-2.pgf}
	% TODO If time is left: Make plot nicer
	\caption[Validation of numerical LE results]{Validation of numerical \ac{LE} results - The first two plots show absolute and relative difference of known exact and numerically calculated results while the third plot shows the behaviour of the maximum value of $\Delta$ as the stepsize decreases.}
	\label{4-NumSol-ValidateLEResults}
\end{figure}\noindent
As can be seen in the last column of plots, the condition for convergence in this case is well fulfilled. 
The double logarithmic plot displays nicely that by lowering the integration stepsize, the maximum difference in this inverval decreases.
% TODO TOV-Terms: Why do we do this? Explain it better.
% Next, we wish to see how accurate numerical \ac{TOV} results are. This is not an easy task since no explicit solutions are known for the \ac{TOV} equation. However one way to at least get confident that solving was a success is by dropping terms from right to left in equation \eqref{4-NumSol-TOVEqBasic2} and solving for these new differential equations. As we have seen in section \ref{3-Mass-LEDerivation}, the last result should reproduce the \ac{LE} equation. These intermediate differential equations have been numerically solved and results can be seen in figure \ref{4-NumSol-TovTerms}.
% \begin{figure}[H]
% 	\centering
% 	\import{pictures/4-NumericalSolutions/}{TOV-Terms.pgf}
% 	\caption[Comparison of \ac{LE} and partial TOV solutions]{Comparison of \ac{LE} and partial \ac{TOV} solutions - The index $i$ represents the number of terms still present in the equation where $i=3$ means the complete \ac{TOV} equation and $i=0$ the \ac{LE} equation. The last figure shows the difference between the \ac{TOV} solution with $0$ terms and the \ac{LE} solution calculated via equation \eqref{4-NumSol-LE-Substitution}. The scale of the difference shows a maximum of $\approx3.5\times10^{-7}$. In order to achieve such a comparison, a polynomial fit of both pressure solutions had to be done. This should however not alter the result in any noticeable way. For further details see \cite{pleyerGithubRepositoryJonas}.}
% 	\label{4-NumSol-TovTerms}
% \end{figure}
% 
\end{subsection}
%
%
\begin{subsection}{Relativistic EOS}
In the previous discussion, we relied on the EOS given in table \ref{4-NumSol-TOVParameters}. 
This is a versatile assumption, but one could ask, what would happen to a star in which the particles have no interaction but are near relativistic speed. The resulting EOS was calculated in the beginning (see equation \eqref{2-IntEner-FinalEOS}) although not written down explicitly. 
Since explicit inversion of the given function is hard, we rely on numerical methods for calculation.
% TODO TOV-Rel: Explain and create plot to put here.
\end{subsection}
%
%
\begin{subsection}{Zero Values of the TOV and LE equation}
Having discussed individual solutions for the \ac{TOV} and \ac{LE} equation, this section now turns to analysing zero values of both equations.
We define a zero value as the first point in which the solution of our differential equation reaches value $0$, or more precisely where the pressure $p$ reaches zero.\footnote{Note that $p_0$ still denotes the initial value while $r_0$ and $\xi_0$ denote values where $p=0$.}
Even now the problem is not well posed since for different solving routines alternative transformations may be used.
This has to be kept in mind when comparing results. 
Apart from the previously defined exact solutions of table \ref{3-Mass-LE-Exact-Results} we will only use the parameter $r$ as defined by equation \eqref{3-Mass-TOV-Eq}.
\begin{figure}[H]
	\centering
% 	\import{pictures/4-NumericalSolutions/}{TOV-Exponents-LESubs-InitialVals-Database-PlotResults.pgf}
% 	\import{pictures/4-NumericalSolutions/}{TOV-Exponents-LESubs-InitialVals-Database-PlotResults-1.pgf}
	\import{pictures/4-NumericalSolutions/}{TOV-Exponents-LESubs-InitialVals-Database-PlotResults-Combo.pgf}
	\label{4-NumSol-TOV-Exponents-Const-p0}
	\caption[Zero Values of TOV and LE equation]{The plot shows the zero values of numerical \ac{TOV} and \ac{LE} results for different parameters. 
	In the first plot results for $p_0=8$ have been omitted for better visual clarity. These behave similar to the $p_0=1$ results.}
\end{figure}


\end{subsection}
%
%
\end{section}
